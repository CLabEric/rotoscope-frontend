(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8021:function(e,t,s){Promise.resolve().then(s.bind(s,9926))},9926:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return VideoUpload}});var a=s(7647),r=s(4423),l=s(7317),n=s(3673),d=s(2509),i=s(9479),c=s(7713),o=s(668),u=s(9329);function cn(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,u.m6)((0,o.W)(t))}let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});m.displayName="Card";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:cn("flex flex-col space-y-1.5 p-6",s),...r})});x.displayName="CardHeader";let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:cn("text-2xl font-semibold leading-none tracking-tight",s),...r})});f.displayName="CardTitle";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:cn("text-sm text-muted-foreground",s),...r})});p.displayName="CardDescription";let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:cn("p-6 pt-0",s),...r})});g.displayName="CardContent";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:cn("flex items-center p-6 pt-0",s),...r})});h.displayName="CardFooter";var v=s(1986);let N=(0,v.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),b=r.forwardRef((e,t)=>{let{className:s,variant:r,...l}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:cn(N({variant:r}),s),...l})});b.displayName="Alert";let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:cn("mb-1 font-medium leading-none tracking-tight",s),...r})});j.displayName="AlertTitle";let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:cn("text-sm [&_p]:leading-relaxed",s),...r})});y.displayName="AlertDescription";var w=s(9908);let _=r.forwardRef((e,t)=>{let{className:s,value:r,...l}=e;return(0,a.jsx)(w.fC,{ref:t,className:cn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...l,children:(0,a.jsx)(w.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});_.displayName=w.fC.displayName;var E=s(6860),C=s(1006),U=s(1961),S=s(3375),k=s(4801),P=s(7388);let R=new E.g({region:P.env.NEXT_PUBLIC_AWS_REGION||"us-east-1",credentials:{accessKeyId:P.env.NEXT_PUBLIC_AWS_ACCESS_KEY_ID||"",secretAccessKey:P.env.NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY||""}}),T=new U.a({region:P.env.NEXT_PUBLIC_AWS_REGION||"us-east-1",credentials:{accessKeyId:P.env.NEXT_PUBLIC_AWS_ACCESS_KEY_ID||"",secretAccessKey:P.env.NEXT_PUBLIC_AWS_SECRET_ACCESS_KEY||""}});async function getUploadUrl(e,t){let s="uploads/".concat(Date.now(),"-").concat(e),a=new C.U({Bucket:P.env.NEXT_PUBLIC_S3_BUCKET_NAME,Key:s,ContentType:t}),r=await (0,k.e)(R,a,{expiresIn:3600});return{url:r,key:s}}async function queueProcessing(e){let t={bucket:P.env.NEXT_PUBLIC_S3_BUCKET_NAME,input_key:e,output_key:"processed/".concat(e)};return await T.send(new S.A({QueueUrl:P.env.NEXT_PUBLIC_SQS_QUEUE_URL,MessageBody:JSON.stringify(t)})),{success:!0}}function VideoUpload(){let[e,t]=(0,r.useState)(null),[s,o]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),[h,v]=(0,r.useState)(!1),[N,j]=(0,r.useState)(0),[w,E]=(0,r.useState)(!1),[C,U]=(0,r.useState)("uploading"),[S,k]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!S||"processing"!==C)return;let checkStatus=async()=>{try{let e=await fetch("/api/status?key=".concat(S)),t=await e.json();if("completed"===t.status){U("completed");try{let e="processed/".concat(S),t=await fetch("/api/video/".concat(encodeURIComponent(e)));if(!t.ok)throw Error("Failed to get video URL");let s=await t.json();p(s.url)}catch(e){U("failed")}}}catch(e){U("failed")}},e=setInterval(checkStatus,5e3);return()=>clearInterval(e)},[S,C]);let P=(0,r.useCallback)(e=>{e.preventDefault(),v(!1);let s=e.dataTransfer.files[0];s&&s.type.startsWith("video/")&&(t(s),o(URL.createObjectURL(s)),handleUpload(s))},[]),handleUpload=async e=>{try{E(!0),j(0);let{url:t,key:s}=await getUploadUrl(e.name,e.type);await new Promise((s,a)=>{let r=new XMLHttpRequest;r.upload.addEventListener("progress",e=>{if(e.lengthComputable){let t=Math.round(e.loaded/e.total*100);j(t)}}),r.addEventListener("load",()=>{r.status>=200&&r.status<300?s(null):a(Error("Upload failed"))}),r.addEventListener("error",()=>a(Error("Upload failed"))),r.open("PUT",t),r.send(e)}),await queueProcessing(s),await new Promise(e=>setTimeout(e,500)),k(s),U("processing"),E(!1)}catch(e){E(!1),U("failed")}};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-indigo-50 to-purple-50 p-8",children:(0,a.jsxs)("div",{className:"w-full max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold text-gray-800 mb-2 flex items-center justify-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500 rounded-lg",children:(0,a.jsx)(l.Z,{className:"w-8 h-8 text-white"})}),"Edge Detection Studio"]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Transform your videos with real-time edge detection"})]}),(0,a.jsxs)(b,{className:"mb-6 bg-white border-blue-100",children:[(0,a.jsx)(n.Z,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)(y,{className:"text-gray-600",children:(()=>{switch(C){case"processing":return"Processing your video with edge detection...";case"completed":return"Processing complete! Check out your edge-detected video.";case"failed":return"Something went wrong. Please try again.";default:return"Transform your videos with real-time edge detection"}})()})]}),e?(0,a.jsxs)(m,{className:"border-none shadow-lg bg-white/80 backdrop-blur-sm",children:[(0,a.jsx)(x,{children:(0,a.jsxs)(f,{className:"flex justify-between items-center text-gray-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5 ".concat("completed"===C?"text-green-500":"text-gray-400")}),"Video Processing"]}),(0,a.jsx)("button",{onClick:()=>{t(null),o(""),p(""),j(0),k(null),U("uploading")},className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(c.Z,{className:"w-5 h-5 text-gray-600"})})]})}),(0,a.jsxs)(g,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Original Video"]}),(0,a.jsx)("div",{className:"relative rounded-xl overflow-hidden bg-gray-900 aspect-video",children:(0,a.jsx)("video",{src:s,controls:!0,className:"w-full h-full object-contain"})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-medium text-gray-700 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),"Processed Video"]}),(0,a.jsx)("div",{className:"relative rounded-xl overflow-hidden bg-gray-900 aspect-video",children:"completed"===C&&u?(0,a.jsx)("video",{src:u,controls:!0,crossOrigin:"anonymous",className:"w-full h-full object-contain"}):(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/90 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"text-center text-white",children:"processing"===C?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-blue-200/30 rounded-full animate-pulse"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 w-12 h-12 border-4 border-blue-400 rounded-full animate-spin border-t-transparent"})]}),(0,a.jsx)("p",{className:"text-blue-100",children:"Processing your video..."})]}):"failed"===C?(0,a.jsx)("div",{className:"text-red-400",children:"Failed to process video"}):"Waiting to start processing..."})})})]})]}),w&&(0,a.jsxs)("div",{className:"mt-8 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"Uploading video..."}),(0,a.jsxs)("span",{children:[N,"%"]})]}),(0,a.jsx)(_,{value:N,className:"h-2"})]})]})]}):(0,a.jsxs)(m,{className:"border-none shadow-lg bg-white/80 backdrop-blur-sm",children:[(0,a.jsx)(x,{children:(0,a.jsxs)(f,{className:"flex items-center gap-2 text-gray-800",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-blue-500"}),"Upload Your Video"]})}),(0,a.jsx)(g,{children:(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),v(!0)},onDragLeave:()=>v(!1),onDrop:P,className:"border-2 border-dashed rounded-xl p-12 transition-all ".concat(h?"border-blue-400 bg-blue-50":"border-gray-200 hover:border-blue-200 hover:bg-blue-50/50"),children:[(0,a.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&(t(a),o(URL.createObjectURL(a)),handleUpload(a))},className:"hidden",id:"video-upload"}),(0,a.jsxs)("label",{htmlFor:"video-upload",className:"flex flex-col items-center gap-6 cursor-pointer",children:[(0,a.jsx)("div",{className:"p-6 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full shadow-lg",children:(0,a.jsx)(d.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-xl font-medium text-gray-700 mb-2",children:"Drop your video here or click to browse"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"MP4, WebM, and other video formats supported"})]})]})]})})]})]})})}}},function(e){e.O(0,[890,449,181,385,744],function(){return e(e.s=8021)}),_N_E=e.O()}]);